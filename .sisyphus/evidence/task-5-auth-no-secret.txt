Task 5: DB Migration Prep Evidence
Generated: 2026-02-27

Files Created:
  - apps/api/src/services/auth-migration.ts

Migration Functions:
  ✓ createOrUpdateUserWithoutToken() - Creates user without storing accessToken
  ✓ connectGitHubWithoutToken() - Connects GitHub without storing accessToken
  ✓ hasLegacyStoredToken() - Checks for existing legacy tokens
  ✓ clearLegacyToken() - Removes token from DB after migration
  ✓ getLegacyToken() - Reads legacy token (backward compat)

Migration Status:
  - WRITES: Disabled - New code doesn't store accessToken in DB
  - READS: Still available for backward compatibility
  - TARGET: Complete removal in future release

Policy Compliance:
  ✓ Aligns with docs/security/trust-boundary.md
  ✓ Tokens should be stored in desktop secure storage only
  ✓ No new accessToken writes to database

Next Steps:
  - Update auth routes to use new functions
  - Migrate existing tokens to local storage
  - Eventually drop accessToken column from schema

Status: MIGRATION HELPERS IMPLEMENTED
